# Real-time Domain Adaptation in Semantic Segmentation

This repository contains the code of our project for the course "Advanced Machine Learning" at Politecnico di Torino.

The goal of the project is to become familiar with the domain adaptation problem in the context of semantic segmentation, by implementing and testing different strategies.

## Project structure
- `datasets/`: contains the classes to handle the datasets used in the project.
  - [**Cityscapes**](datasets/cityscapes.py)
    
  - [**GTA5**](datasets/gta5.py)

- `model/`: contains the implementation of the models used in the project and their components.
  - [**BiSeNet**](model/model_stages.py)
    - AttentionRefinement module
    - ContextPath module
    - FeatureFusion module
  - [**BiSeNet Discriminator**](model/model_stages.py)
  - [**STDCNet813 Backbone**](model/stdcnet.py)
- `training/`: contains the code to implement the different training strategies used in the project.
  - [**Simple Training**](training/simple_train.py)
    
    Trains the model on the source domain and tests it on the target domain.
  - [**Single Layer Domain Adaptation**](training/single_layer_da_train.py)
  
    Performs adversarial training using a generator and a discriminator.
  - [**Fourier Domain Adaptation**](training/fda_train.py)
   
    Performs semi-supervised learning with style transfer.
  - [**Self-Learning**](training/fda_self_learning_train.py) 
  
    Performs self-supervised using the pseudo-labels generated by multiple models trained with FDA and different betas.

- `utils/`: contains the utility functions and classes used in the various stages of the project.
  - [**General Functions**](utils/general.py)
    - Various utility functions
    - Save and Load Checkpoints
  - [**Data Augmentation**](utils/aug.py)
    - Interface Class
    - Various Transformations
  - [**FDA**](utils/fda.py)
    - Style Transfer
    - Entropy Minimization Loss
    - **MBT Adaptation**
    - **Pseudo-Label Generation**

- `eval.py`: contains the code to evaluate the performance of the models on the target domain.
- `main.py`: contains the code to initialize the training/testing process according to the chosen arguments.
- `test.ipynb`: contains the code to perform a quick test of some of the implemented functions.

## Requirements
-  The two datasets are not included in the repository, but they can be downloaded from [datasets_drive_link](https://drive.google.com/drive/u/0/folders/1iE8wJT7tuDOVjEBZ7A3tOPZmNdroqG1m).
- The pre-trained weights for STDCNet813 are available at [stdcnet_drive_link](https://drive.google.com/drive/folders/1wROFwRt8qWHD4jSo8Zu1gp1d6oYJ3ns1).



